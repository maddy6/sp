WITH expected_columns AS (

    /* ===============================
       Incumbent / Role Fields
       =============================== */
    SELECT 'INCUMBENT_ROLE_FIELDS' AS category, 'POSITION' AS column_name FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'POSITION_ID' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT_GEID' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'EFFECTIVE_DATE_OF_REGULATORY_TAG' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'REGULATORY_TAG' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'REGULATORY_TAG_X1BAU_IN_SCOPE_RESOURCE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT_C_LEVEL' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT_OFFICER_TITLE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT_BUSINESS_TITLE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT_DIRECT_MANAGER' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT_MATRIX_MANAGER' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'COVERED_EMPLOYEE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'CRITICAL_ROLE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'KEY_ROLE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'SUCCESSION_GAP' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'ACROSS_EACH_READINESS_LEVEL' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'SUCCESSION_PLAN_UPDATE_DATE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'NUMBER_OF_SUCCESSORS' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT_EMERGENCY_COVER' FROM dual UNION ALL

    /* ===============================
       Incumbent / Role Attributes
       =============================== */
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_US_MINORITY' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_UK_MINORITY' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_ETHNICITY' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_US_HISPANIC_OR_LATINO' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_GENDER' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_WORK_REGION' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_WORK_COUNTRY' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_WORK_STATE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_WORK_CITY' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_POTENTIAL_CURRENT_YEAR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_RATIONALE_FOR_POTENTIAL' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_TALENT_POOL' FROM dual UNION ALL

    /* ===== MS Level Descriptions ===== */
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MS_L02_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MS_L03_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MS_L04_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MS_L05_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MS_L06_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MS_L07_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MS_L08_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MS_L09_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MS_L10_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MS_L11_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MS_L12_DESCR' FROM dual UNION ALL

    /* ===== MG Level Descriptions ===== */
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MG_L02_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MG_L03_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MG_L04_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MG_L05_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MG_L06_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MG_L07_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MG_L08_DESCR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MG_L09_DESCR' FROM dual UNION ALL

    /* ===== Management Chain ===== */
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MGMT_CHAIN_L02' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MGMT_CHAIN_L03' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MGMT_CHAIN_L04' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MGMT_CHAIN_L05' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MGMT_CHAIN_L06' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MGMT_CHAIN_L07' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MGMT_CHAIN_L08' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_MGMT_CHAIN_L09' FROM dual UNION ALL

    /* ===== Organization ===== */
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_ORG_LEVEL_FROM_TOP' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_COMPANY_LEGAL_VEHICLE' FROM dual
)

SELECT 
    e.category,
    e.column_name,
    CASE 
        WHEN c.column_name IS NOT NULL THEN 'PRESENT'
        ELSE 'NOT_PRESENT'
    END AS column_status
FROM expected_columns e
LEFT JOIN all_tab_columns c
    ON c.owner = 'WFA_APP_USR_TALD'
   AND c.table_name = 'WD_TALENT_LIST_INCUMBENT'
   AND c.column_name = e.column_name
ORDER BY 
    e.category,
    column_status DESC,
    e.column_name;
































WITH expected_columns AS (

    -- Incumbent / Role Fields
    SELECT 'INCUMBENT_ROLE_FIELDS' AS category, 'POSITION' AS column_name FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'POSITION_ID' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT_GEID' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'EFFECTIVE_DATE_OF_REGULATORY_TAG' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'REGULATORY_TAG' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'REGULATORY_TAG_X1BAU_IN_SCOPE_RESOURCE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT_C_LEVEL' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT_OFFICER_TITLE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT_BUSINESS_TITLE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT_DIRECT_MANAGER' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT_MATRIX_MANAGER' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'COVERED_EMPLOYEE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'CRITICAL_ROLE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'KEY_ROLE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'SUCCESSION_GAP' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'ACROSS_EACH_READINESS_LEVEL' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'SUCCESSION_PLAN_UPDATE_DATE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'NUMBER_OF_SUCCESSORS' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_FIELDS', 'INCUMBENT_EMERGENCY_COVER' FROM dual UNION ALL

    -- Incumbent / Role Attributes
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_US_MINORITY' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_UK_MINORITY' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_ETHNICITY' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_US_HISPANIC_OR_LATINO' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_GENDER' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_WORK_REGION' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_WORK_COUNTRY' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_WORK_STATE' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_WORK_CITY' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_POTENTIAL_CURRENT_YEAR' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_RATIONALE_FOR_POTENTIAL' FROM dual UNION ALL
    SELECT 'INCUMBENT_ROLE_ATTRIBUTES', 'INCUMBENT_TALENT_POOL' FROM dual
)



SELECT 
    e.category,
    e.column_name,
    CASE 
        WHEN c.column_name IS NOT NULL THEN 'PRESENT'
        ELSE 'NOT_PRESENT'
    END AS column_status
FROM expected_columns e
LEFT JOIN all_tab_columns c
    ON c.owner      = 'WFA_APP_USR_TALD'
   AND c.table_name = 'WD_TALENT_LIST_INCUMBENT'
   AND c.column_name = e.column_name
ORDER BY 
    e.category,
    column_status DESC,
    e.column_name;


